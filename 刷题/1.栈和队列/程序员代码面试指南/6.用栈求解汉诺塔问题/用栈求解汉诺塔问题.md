# 6. 用栈求解汉诺塔问题

## 题目
修改游戏规则: 
* 限制不能从最左侧的塔直接移动到最右侧
* 限制不能从最右侧的塔直接移动到最左侧
* 必须经过中间

求: 当塔有N层时，打印 最优移动过程 和 最优移动总步数。


例如: 当塔数为2层时，最上层记为1，最下层塔记为2，则打印:
```text
Move 1 from left to mid
Move 1 from mid to right

Move 2 from left to mid

Move 1 from right to mid
Move 1 from mid to left

Move 2 from mid to right

Move 1 from left to mid
Move 1 from mid to right

It will move 8 steps
```

## 难度
3颗星


## 要求
* 方法1: 递归
* 方法2: 非递归，用栈模拟汉诺塔的3个塔


## 递归: 解题思路
首先，考虑只剩最上层的塔需要移动，则有如下处理:
* 1.如果希望从 左 到 中，则打印: Move 1 from left to mid
* 2.如果希望从 中 到 左，则打印: Move 1 from mid to left
* 3.如果希望从 右 到 中，则打印: Move 1 from right to mid
* 4.如果希望从 中 到 右，则打印: Move 1 from mid to right
* 5.如果希望从 左 到 右，则打印: Move 1 from left to mid, Move 1 from mid to right
* 6.如果希望从 右 到 左，则打印: Move 1 from right to mid, Move 1 from mid to left

其实归纳下来，就只有2种情况:
* 第一，起止中有 mid的情况
* 第二，不通过中间，直接左到右，或者右到左

### case 1: 如果剩下的N层塔都在左，希望全部移到中，则有三个步骤
* 1.将1~N-1层塔，先全部从左移到右(递归)
* 2.将第N层塔从左移到中
* 3.将1~N-1层塔，全部从右移到中(递归)

### case 2: 如果剩下的N层塔都在中，希望全部移到左，同样也有三个步骤:
* 1.将1~N-1层塔，先全部从中移到右(递归)
* 2.将第N层塔从中移到左
* 3.将1~N-1层塔，全部从右移到左(递归)

### case 3: 如果剩下的N层塔都在左，希望全部移到右，则有五个步骤:
* 1.将1~N-1层塔先全部从左移到右(递归)
* 2.将第N层塔从左移到中
* 3.将1~N-1层塔全部从右移到左(递归)
* 4.将第N层塔从中移到右
* 5.将第1~N-1层塔全部从左移到右(递归)


## 栈: 解题思路

修改后的汉诺塔问题不能让任何塔从 左 直接移动到 右，也不能从 右 直接移动到左，而是要经过中间过程，即实际动作只有4个:
* 左 到 中
* 中 到 左
* 右 到 中
* 中 到 右

现在，把 左 、 中 、 右，想成3个栈，依次记为 `LS` 、`MS` 、`RS`。

最初，所有的塔都在 LS 上。

那么如上4个动作，就可以看作是: 某个栈把栈顶元素弹出，然后压入到另一个栈离，作为这一个栈的栈顶。

### 一个动作能发生的先决条件
> 原则1: 一个动作能发生的先决条件: 不违反 小压大 的原则。

from 栈弹出的元素 num，如果想要压入 to 栈，那么 num 的值必须小于当前 to 栈的栈顶。

> 原则2: 相邻不可逆原则。

如果我们把4个动作依次定义为: L -> M、M -> L、R -> M、M -> R，很明显，L -> M 和 M -> L 过程互为逆过程。

在修改后的汉诺塔游戏中，如果想走出最少步数，那么任何两个相邻的动作都不是互为逆过程的。


### 非递归方法核心结论
* 1.游戏的第一个动作一定是 L -> M
* 2.在走出最少步数过程中的任何时刻，4个动作只有1个动作不违反小压大和相邻不可逆原则，另外3个动作一定都会违反。
